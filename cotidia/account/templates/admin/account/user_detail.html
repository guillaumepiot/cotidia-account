{% extends "admin/page.html" %}{% load i18n %}
{% block title %}
    {% trans "User details" %}
{% endblock title %}
{% block body_class %}content-centered{% endblock body_class %}
{% block toolbar %}
    {% if not request.user.is_superuser and object.is_superuser %}
        {# Non superuser can't update superusers #}
    {% else %}
        <a href="{% url 'account-admin:user_update' object.uuid %}"
            class="[ toolbar__item ] [ btn btn--change btn--small pull-right ]">
            <span class="fa fa-pencil"></span>
            {% trans "Edit User" %}
        </a>
    {% endif %}
    <span class="toolbar__breadcrumbs">
        <a href="{% url 'account-admin:user_list' %}">{% trans "Users" %}</a>
        &nbsp;<span class="fa fa-angle-right"></span>&nbsp;
        {{object}}
    </span>
{% endblock toolbar %}

{% block page_content %}
<div class="content__detail">
    <fieldset>
        <legend>{% trans "Contact details" %}</legend>
        <div class="form__group">
            <label class="form__label">{% trans "Full name" %}</label>
            <br>
            {{object.first_name}} {{object.last_name}}
        </div>
        <div class="form__group">
            <label class="form__label">{% trans "Email" %}</label>
            <br>
            <a href="mailto:{{object.email}}">{{object.email}}</a>
        </div>
    </fieldset>

    {% if ACCOUNT_ENABLE_TWO_FACTOR %}
    <fieldset>
        <legend>{% trans "Security" %}</legend>
        <div class="grid">
            <div class="grid__span-2">
                <span class="form__label--inline">
                    {% trans "Two-Factor Authentication" %}
                </span>
            </div>
            <div class="grid__span-8">
                <div class="form__control">
                    <p>
                    {% if user.two_factor_auth_enabled %}
                        <span class="label label--primary">Enabled</span>
                        {% if request.user.is_superuser %}
                        <p>
                            <a href="{% url 'account-admin:user-disable' object.uuid %}">
                                    Disable two-factor authentication
                            </a>
                        </p>
                        {% endif %}
                    {% else %}
                        <span class="label label--danger">Disabled</span>
                    {% endif %}
                    </p>
                </div>
            </div>
        </div>
    </fieldset>
    {% endif %}
    <fieldset>
        <legend>{% trans "Role & Permissions" %}</legend>

        <p>
        {% if object.is_active %}
            <span class="fa fa-check fa-green"></span>
        {% else %}
            <span class="fa fa-remove fa-red"></span>
        {% endif %}
        {% trans "Active" %}</p>

        <p>{% if object.is_staff %}
            <span class="fa fa-check fa-green"></span>
        {% else %}
            <span class="fa fa-remove fa-red"></span>
        {% endif %}
        {% trans "Staff" %}</p>

        <p>{% if object.is_superuser %}
            <span class="fa fa-check fa-green"></span>
        {% else %}
            <span class="fa fa-remove fa-red"></span>
        {% endif %}
        {% trans "Superuser" %}
        </p>

        <div class="form__group">
            <label class="form__label">{% trans "Role" %}</label>
            <ul>
            {% for group in object.groups.all %}
                <li>{{group}}</li>
            {% empty %}
                <li><span class="text-italic">{% trans "No role assigned" %}</span></li>
            {% endfor %}
            </ul>
        </div>

        <div class="form__group">
            <label class="form__label">{% trans "Permissions" %}</label>
            <ul>
            {% for permission in object.user_permissions.all %}
                <li>{{permission}}</li>
            {% empty %}
                <li><span class="text-italic">{% trans "No permission assigned" %}</span></li>
            {% endfor %}
            </ul>
        </div>
    </fieldset>
    <div class="content__inner">
        {% if perms.account.delete_user %}
            {% if not request.user.is_superuser and object.is_superuser %}
                {# Non superuser can't delete superusers #}
            {% else %}
                <a href="{% url 'account-admin:user_delete' object.uuid %}" class="btn btn--delete btn--transparent pull-right">
                    {% trans "Delete User" %}
                </a>
            {% endif %}
        {% endif %}
        {% if perms.account.change_user %}

        {% if not request.user.is_superuser and object.is_superuser %}
                {# Non superuser can't update superusers #}
            {% else %}
                <a href="{% url 'account-admin:user_update' object.uuid %}" class="btn btn--change">
                    {% trans "Edit User" %}
                </a>
            {% endif %}
        {% endif %}
    </div>
</div>
{% endblock page_content %}
